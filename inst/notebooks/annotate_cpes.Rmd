---
title: "annotate_cpes"
author: "Humbert Costas"
date: '2022-07-09'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

version <- as.character(packageVersion("mitre"))
seed <- "100"
data_path <- "/DEVEL/code/data/annotation"
num_samples <- 500   # value 0 means all
```

```{r imports}
suppressPackageStartupMessages(library(dplyr, warn.conflicts = FALSE))
suppressPackageStartupMessages(library(stringr, warn.conflicts = FALSE))
suppressPackageStartupMessages(library(stringdist, warn.conflicts = FALSE))

set.seed(seed)

if (!dir.exists(data_path))
  dir.create(data_path)

name_folder <- file.path(data_path, paste0("v", version))
if (!dir.exists(name_folder))
  dir.create(name_folder)
name_folder <- file.path(data_path, paste0("v", version), seed)
if (!dir.exists(name_folder))
  dir.create(name_folder)
```

## Annotate CPE standard


```{r load_data}
cpes_rasa_vpv_15k <- nlp.ner_cpe_trainset(kind="RASA", type="vpv", num_samples = 15000, 
                                          rdataset = "/DEVEL/code/data/annotation/cpes_vpv_rasa.rds")
cpes_rasa_vpv_10k <- nlp.ner_cpe_trainset(kind="RASA", type="vpv", num_samples = 10000, 
                                          rdataset = "/DEVEL/code/data/annotation/cpes_vpv_rasa.rds")
cpes_rasa_vpv_5k <- nlp.ner_cpe_trainset(kind="RASA", type="vpv", num_samples = 5000, 
                                          rdataset = "/DEVEL/code/data/annotation/cpes_vpv_rasa.rds")
cpes_rasa_vpv_2k <- nlp.ner_cpe_trainset(kind="RASA", type="vpv", num_samples = 2000, 
                                          rdataset = "/DEVEL/code/data/annotation/cpes_vpv_rasa.rds")
cpes_rasa_vpv_1k <- nlp.ner_cpe_trainset(kind="RASA", type="vpv", num_samples = 1000, 
                                          rdataset = "/DEVEL/code/data/annotation/cpes_vpv_rasa.rds")
```

```{r save, cache=TRUE}
readr::write_csv(x = cpes_rasa_vpv_15k, 
                 file = file.path(name_folder,"cpes_rasa_vpv_15k.csv"), 
                 col_names = FALSE)
readr::write_csv(x = cpes_rasa_vpv_10k, 
                 file = file.path(name_folder,"cpes_rasa_vpv_10k.csv"), 
                 col_names = FALSE)
readr::write_csv(x = cpes_rasa_vpv_5k, 
                 file = file.path(name_folder,"cpes_rasa_vpv_5k.csv"), 
                 col_names = FALSE)
readr::write_csv(x = cpes_rasa_vpv_2k, 
                 file = file.path(name_folder,"cpes_rasa_vpv_2k.csv"), 
                 col_names = FALSE)
readr::write_csv(x = cpes_rasa_vpv_1k, 
                 file = file.path(name_folder,"cpes_rasa_vpv_1k.csv"), 
                 col_names = FALSE)

```

```{r load_data_ent}
cpes_enti_vpv_15k <- nlp.ner_cpe_trainset(kind = "entities", type = "vpv", num_samples = 15000, 
                                          rdataset = "/DEVEL/code/data/annotation/cpes_vpv_entities.rds")
cpes_enti_vpv_10k <- nlp.ner_cpe_trainset(kind = "entities", type = "vpv", num_samples = 10000, 
                                          rdataset = "/DEVEL/code/data/annotation/cpes_vpv_entities.rds")
cpes_enti_vpv_5k <- nlp.ner_cpe_trainset(kind = "entities", type = "vpv", num_samples = 5000, 
                                          rdataset = "/DEVEL/code/data/annotation/cpes_vpv_entities.rds")
cpes_enti_vpv_2k <- nlp.ner_cpe_trainset(kind = "entities", type = "vpv", num_samples = 2000, 
                                          rdataset = "/DEVEL/code/data/annotation/cpes_vpv_entities.rds")
cpes_enti_vpv_1k <- nlp.ner_cpe_trainset(kind = "entities", type = "vpv", num_samples = 1000, 
                                          rdataset = "/DEVEL/code/data/annotation/cpes_vpv_entities.rds")
```

```{r save_ent, cache=TRUE}
readr::write_csv(x = cpes_enti_vpv_15k, 
                 file = file.path(name_folder,"cpes_enti_vpv_15k.csv"), 
                 col_names = FALSE)
readr::write_csv(x = cpes_enti_vpv_10k, 
                 file = file.path(name_folder,"cpes_enti_vpv_10k.csv"), 
                 col_names = FALSE)
readr::write_csv(x = cpes_enti_vpv_5k, 
                 file = file.path(name_folder,"cpes_enti_vpv_5k.csv"), 
                 col_names = FALSE)
readr::write_csv(x = cpes_enti_vpv_2k, 
                 file = file.path(name_folder,"cpes_enti_vpv_2k.csv"), 
                 col_names = FALSE)
readr::write_csv(x = cpes_enti_vpv_1k, 
                 file = file.path(name_folder,"cpes_enti_vpv_1k.csv"), 
                 col_names = FALSE)

```
